#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
PLOTS THE RECALL
Created on Mon Jun  7 14:52:59 2021

@author: aolza
"""
import pandas as pd

def plot(N,dic,yr,top):#lin17,lin17Ac,lasso17Ac,log17,log17Ac,nb17Ac,yr,top):
        
    d=pd.DataFrame(index=N)
    for key, value in dic.items():
        d[key]=value
    # d['lin{0}'.format(yr)]=lin17
    # d['lin{0}Ac'.format(yr)]=lin17Ac
    # d['lasso{0}Ac'.format(yr)]=lasso17Ac
    # d['log{0}'.format(yr)]=log17    
    # d['log{0}Ac'.format(yr)]=log17Ac
    # d['naiveBayes{0}Ac'.format(yr)]=nb17Ac
    ax=d.plot.barh(title='Costes 20{0} - Recall TOP{1}'.format(yr,top),figsize=(5,10),width=0.9)
    ax.set_xlim([0, max(d[key])+15])
    for p in ax.patches:
        ax.annotate(str(round(p.get_width(),2)), ( p.get_width() * 1.005,p.get_y() ))
    ax.legend(bbox_to_anchor=(1.05, 1))

"""TOP 1 """

N=[22405,44810,50000,67215,89620,1e5,112025]

lin17=[23.90984,34.99219,37.00513,42.71368,48.38206,50.76099,53.25597]
lin18=[23.08138,33.99964,35.97626,41.4867,47.36302,49.90184,52.39604]
lin19=[23.41435,34.32094,36.41444,42.18043,47.99077,50.23507,52.69671]

lin17Ac=[25.13278,36.02321,37.96474,43.43673,49.20777,51.47512,53.77817]
lin18Ac=[24.08085,35.05711,36.90434,42.18722,47.89399,50.16955,52.53436]
lin19Ac=[24.50989,35.48745,37.28378,42.71711,48.43431,50.61208,52.83864]

lasso17Ac=[25.0614,36.0366,37.871,43.3162,49.1408,51.4974,53.7603]
lasso18Ac=[24.0585,34.9634,36.7125,42.0311,47.9475,50.1249,52.521]
lasso19Ac=[24.4256,35.4431,37.2439,42.6772,48.3589,50.5633,52.8475]

nb17Ac=[19.910734211113592, 29.91742914528007, 31.787547422450345, 36.969426467306405, 42.76723945547869, 45.09261325596965, 47.5251060031243]
nb18Ac=[18.954131715152595, 29.073710512225592, 30.970016062823486, 36.36444761734785, 42.05336426914153, 44.36908798857755, 46.8677494199536]
nb19Ac=[19.13421449481061, 29.286791448593984, 31.180697241195777, 36.69830568615276, 42.41550607646589, 44.77512640823206, 47.19240663532334]

nb17Acbal=[20.01338986833296, 29.90403927694711, 31.908056237447, 37.04976567730417, 42.77616603436733, 44.958714572640034, 47.46708324034814]
nb18Acbal=[19.11922184543994, 29.06032482598608, 30.996787435302515, 36.36890951276102, 41.848117080135644, 44.2664643940746, 46.58665000892379]
nb19Acbal=[19.3293710636033, 29.477512640823207, 31.38472456311541, 36.77814246429522, 42.39776457021201, 44.7396433957243, 47.21014814157722]

log17= [24.690917205980806, 35.78665476456148, 37.741575541173844, 43.41887971434947, 49.185449676411515, 51.5152867663468, 53.99687569738897]
log18= [23.594502944850973, 34.65554167410316, 36.56077101552739, 42.20060681777619, 47.81813314295913, 50.2498661431376, 52.641442084597536]
log19= [23.893373547414175, 35.27898518584228, 37.19506786126142, 42.57074425618735, 48.22141399804843, 50.496762175108664, 53.02049143972323]

log17Ac=[24.824815889310422, 36.027672394554784, 38.036152644499, 43.71792010711895, 49.14528007141263, 51.390314661905826, 53.693372015175186]
log18Ac=[23.75959307513832, 34.97233624843834, 36.815099054078175, 42.1827592361235, 47.777976084240585, 49.77690522934142, 52.01677672675353]
log19Ac=[24.35465271001508, 35.30116206865963, 37.110795706555486, 42.45985984210059, 48.225849374611904, 50.443537656347026, 52.714450456843785]

#rus scoring='recall'
log17bal=[23.865208658781523, 35.130551216246374, 37.174737781745144, 42.740459718812765, 48.55612586476233, 50.97969203302834, 53.4568176746262]
log18bal=[22.719971443869355, 33.995181152953776, 35.92718186685704, 41.29930394431555, 47.398714974121006, 49.63412457611994, 51.990005354274494]
log19bal=[23.148230284751175, 34.38303912002129, 36.166060498536325, 41.728022709128005, 47.65812117448771, 49.89798633904019, 52.33300807238535]

#log rus default scoring C=1e4
l17=[23.700066949341664, 34.9609462173622, 37.09439857174738, 42.6824369560366, 48.4847132336532, 50.74313769247936, 53.33184557018522]
l18=[22.541495627342496, 33.90148134927718, 35.98964840264144, 41.330537212207744, 47.34963412457612, 49.55381045868285, 52.048009994645724]
l19= [22.961944469085424, 34.32094384813271, 36.299121795440435, 41.71471657943759, 47.706910316685885, 49.96895236405571, 52.23986516455247]

#log rus default scoring no penalty
ln17=[23.708993528230305, 34.9609462173622, 37.07208212452578, 42.673510377147956, 48.502566391430484, 50.73421111359072, 53.33184557018522]
ln18=[22.51918615027664, 33.89255755845083, 35.9807246118151, 41.30376583972872, 47.340710333749776, 49.55381045868285, 52.048009994645724]
ln19=[22.944202962831543, 34.312073095005765, 36.29025104231349, 41.70584582631066, 47.68916881043201, 49.97782311718265, 52.23986516455247]

RFoobGini17= [47.38674403035037, 64.10622628877482, 66.63691140370453, 73.07297478241463, 78.90203079669716, 80.88819459941978, 82.81633563936622]
RFoobGini18=[19.003,29.609,32.014,37.489,43.236,45.699,48.126]

RFtunedGini17= [29.04262441419326, 42.12898906494086, 44.49899575987503, 50.97522874358402, 57.29970988618612, 59.696496317786206, 62.05311314438741]
RFtunedGini18= [20.212386221666964, 31.108334820631804, 32.97786899875067, 39.1129751918615, 44.8465107977869, 47.108691772264855, 49.65197215777262]
RFtunedGini19= [20.380555309145745, 31.304887784972944, 33.13669830568615, 38.955912356959104, 45.2763239599042, 47.58715514947219, 50.106449037523284]

histOOB17cat=[25.415104445634707, 36.4131405106231, 38.417246920192824, 44.26888055704339, 50.10712372790573, 52.303160149973216, 54.55722192465631]
histOOB18= [23.621274317330002, 34.53507049794753, 36.40014278065322, 41.81688381224344, 47.568266999821525, 49.92860967338925, 52.40049973228628]
histOOB19= [24.11957775215116, 34.71569236228156, 36.73822407522399, 42.446553712410186, 48.004080546438395, 50.2971702297525, 52.581389159939675]

histOOB18cat= [23.58557915402463, 34.32982330894164, 36.14135284668927, 41.8391932893093, 47.398714974121006, 49.52257719079065, 52.03908620381938]
histOOB19cat= [24.199414530293623, 34.7245631154085, 36.77370708773175, 42.20704337798279, 47.91093763860552, 50.106449037523284, 52.53703539430498]


hist17recall= [25.33029816104267, 36.377432601321196, 38.426173897518304, 44.01446170326727, 50.02678093197643, 52.245134797357615, 54.601856811283696]
hist18recall= [23.612350526503658, 34.24504729609138, 36.03872925218633, 41.61163662323755, 47.49687667321078, 49.70997679814385, 51.89184365518472]
hist19recall= [24.283686684999555, 34.75561075135279, 36.74265945178745, 42.15825423578462, 47.74682870575712, 49.96008161092877, 52.30639581300452]

"""default scoring: {'min_samples_leaf': 10, 
'max_leaf_nodes': 15, 'max_iter': 100, 'max_depth': 10, 
'learning_rate': 0.1, 'l2_regularization': 0.1}
"""
hist17default= [25.357079093019102, 36.12747723620782, 38.185145509730404, 43.77343331547938, 49.647384395643634, 51.865738261024816, 54.128727013033384]
hist18default= [24.08531144029984, 34.543994288773874, 36.33321434945565, 41.638407995716584, 47.19792968052829, 49.379796537569156, 51.74013921113689]
hist19default= [24.110706999024217, 34.75117537478932, 36.880156125255034, 42.23365563736361, 47.93754989798634, 49.96008161092877, 52.24430054111594]

d={'lin17':lin17,'lin17Ac':lin17Ac,'lasso17Ac':lasso17Ac,
   'log17':log17,'log17Ac':log17Ac,'log17balAc':log17bal,'RFoobGini17':RFoobGini17,
   'hist17default':hist17default}
plot(N,d,17,1)

d={'lin18':lin18,'lin18Ac':lin18Ac,'lasso18Ac':lasso18Ac,
   'log18':log18,'log18Ac':log18Ac,'log18balAc':log18bal,
   'histOOB18':histOOB18,
   'hist18default':hist18default,'RFoobGini18':RFoobGini18}
plot(N,d,18,1)
d={'lin19':lin19,'lin19Ac':lin19Ac,'lasso19Ac':lasso19Ac,
   'log19':log19,'log19Ac':log19Ac,'log19balAc':log19bal,
   'hist19default':hist19default}
plot(N,d,19,1)


"""TOP 5% """

# N=[22405,44810,50000,67215,89620,1e5,112025]

# lin17=[12.1481,20.6175,22.293,27.2847,32.7915,35.0722,37.5377]
# lin18=[11.8764,20.1851,21.8573,26.7394,32.1703,34.4619,36.8596]
# lin19=[11.6089,19.706,21.3524,26.1736,31.4968,33.6772,36.1814]

# lin17Ac=[12.2489,20.7684,22.4314,27.457,32.9879,35.265,37.702]
# lin18Ac=[11.9013,20.244,21.8859,26.8242,32.2836,34.5627,37.0033]
# lin19Ac=[11.7793,19.9695,21.5325,26.3678,31.6476,33.844,36.2231]

# log17= [12.20966561333976, 20.61217931551604, 22.23948012068627, 27.15887383286023, 32.70401513934265, 35.00794458429293, 37.48594076375127]
# log18= [11.847799898271507, 20.059252384819253, 21.767220224338097, 26.70997563870323, 32.140849343672755, 34.41813979636454, 36.85873124938651]
# log19= [11.466132065429514, 19.571195401483163, 21.141290849093426, 25.972217294113474, 31.3247347691871, 33.549480183089095, 35.97824929922294]

# log17Ac=[12.129327120489886, 20.548801171156697, 22.2350168710835, 27.112456036991414, 32.63974434506275, 34.888329494938674, 37.336868227018726]
# log18Ac=[11.813890400935188, 20.081561264645778, 21.687800612155662, 26.535966376056326, 32.03287436531237, 34.25216173045519, 36.69186082828409]
# log19Ac=[11.545967427172409, 19.57740481850761, 21.151935563992478, 26.025440868608737, 31.34247596068552, 33.54859312351417, 35.97824929922294]

# # plot(N,lin17,lin17Ac,log17,log17Ac,17,5)1
# # 
# N=[50000, 100000, 112026, 224052, 336078, 448104, 560130]

# lin17=[22.293,35.0722,37.5377,54.4329,65.2607,72.7929,78.4461]
# lin18=[21.8573,34.4619,36.8596,53.8028,64.6975,72.3923,78.0748]
# lin19=[21.3524,33.6772,36.1823,52.8829,63.9304,71.7472,77.5964]

# lin17Ac=[22.4314,35.265,37.702,54.0749,64.5056,72.1636,77.7668]
# lin18Ac=[21.8859,34.5627,37.0042,53.536,64.2058,71.7927,77.5323]
# lin19Ac=[21.5325,33.844,36.2231,52.6727,63.4948,71.332,77.1928]

# log17=[22.23948012068627, 35.00794458429293, 37.48594076375127, 54.44093335475693, 65.3964258297181, 73.2222876832164, 79.0521843143556]
# log18=[21.767220224338097, 34.41813979636454, 36.85873124938651, 53.68141134897335, 64.8064035408654, 72.70374699945566, 78.4665768362439]
# log19=[21.141290849093426, 33.549480183089095, 35.97824929922294, 52.865202426995, 63.84966114324238, 72.02657630486463, 77.89979775041692]

# log17Ac=[22.2350168710835, 34.888329494938674, 37.336868227018726, 53.87320800528449, 64.50734650884615, 72.19038437505579, 77.76051987931373]
# log18Ac=[21.687800612155662, 34.25216173045519, 36.69186082828409, 53.44226015723299, 64.19603258881165, 71.88099551145338, 77.60099229897469]
# log19Ac=[21.151935563992478, 33.54859312351417, 35.97824929922294, 52.55118333747294, 63.417663130255825, 71.32491218110208, 77.1697477202569]

# # plot(N,lin17,lin17Ac,log17,log17Ac,17,5)
# # plot(N,lin18,lin18Ac,log18,log18Ac,18,5)
# # plot(N,lin19,lin19Ac,log19,log19Ac,19,5)